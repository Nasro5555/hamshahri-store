<!doctype html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ام حواله m Hawala | همشهری استور</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <div class="bg"></div>

  <header class="topbar">
    <div class="brand">
      <img class="logoImg" src="logo.jpg" alt="لوگو" />
      <div class="brandText">
        <div class="brandName">همشهری استور</div>
        <div class="brandTag">پرداخت: ام حواله m Hawala</div>
      </div>
    </div>
    <div class="actions">
      <a class="btn" href="payment.html">بازگشت</a>
    </div>
  </header>

  <main class="container">
    <section class="hero cardBox">
      <h2 class="pageTitle">ام حواله m Hawala</h2>
      <p class="pageSub">بعد از ارسال پول، رسید را آپلود کنید و فرم را بفرستید.</p>

      <div class="payInfo">
        <div><b>شماره:</b> 0789880937</div>
        <div><b>نام:</b> nasrullah qanbari</div>
      </div>

      <form class="payForm" id="payForm">
        <label>نام مشتری</label>
        <input name="customerName" required placeholder="مثال: احمد" />

        <label>نام پابجی</label>
        <input name="pubgName" required placeholder="نام داخل بازی" />

        <label>ایدی پابجی</label>
        <input name="pubgId" required inputmode="numeric" placeholder="مثال: 1234567890" />

        <label>مبلغ (افغانی)</label>
        <input name="amount" required inputmode="numeric" placeholder="مثال: 1520" />

        <label>آپلود رسید</label>
        <input name="receipt" type="file" accept="image/*" />

        <label>توضیح (اختیاری)</label>
        <input name="note" placeholder="مثلاً: خرید یوسی پابجی" />

        <button class="btn btnPrimary" type="submit">ارسال به تلگرام</button>
        <div class="smallNote" id="status"></div>
      </form>
    </section>
  </main>

  <script>
    const WORKER_URL = "https://white-frog-ba40.nasro-mlbb.workers.dev";

    const form = document.getElementById("payForm");
    const statusEl = document.getElementById("status");

    form.addEventListener("submit", async (e) => {
      e.preventDefault();
      statusEl.textContent = "در حال ارسال...";

      const fd = new FormData(form);
      fd.append("page", "hawala");

      try {
        const res = await fetch(WORKER_URL, { method: "POST", body: fd });
        const data = await res.json();

        if (data.ok) {
          statusEl.textContent = "✅ ارسال شد. لطفاً منتظر تایید باشید.";
          form.reset();
        } else {
          statusEl.textContent = "❌ خطا: " + (data.error || "مشکل نامشخص");
        }
      } catch (err) {
        statusEl.textContent = "❌ خطا در ارتباط. دوباره تلاش کن.";
      }
    });
  </script>
</body>
</html>
